{% extends 'base.html' %}
{% block title %}{{ farm.name }} | Sponsor a Farm{% endblock %}
{% block content %}
<div class="container py-5">
  <div class="row">
    <div class="col-md-7">
  <h1 class="mb-3" style="font-family: var(--font-heading); color: #ffb366; text-shadow: 1px 1px 2px #2c1810, 0 2px 8px #2c1810; font-weight:700; letter-spacing:0.5px;">{{ farm.name }}</h1>
  <p class="mb-2" style="color:#222; font-size:1.1rem;"><i class="fas fa-map-marker-alt me-1"></i> {{ farm.location }}</p>
      {% if farm.image %}
      <img src="{{ farm.image.url }}" class="img-fluid rounded mb-3" alt="{{ farm.name }}">
      {% endif %}
      {% if farm.video %}
      <div class="mb-3">
        <video src="{{ farm.video.url }}" class="w-100 rounded" controls style="max-height:320px;"></video>
      </div>
      {% endif %}
  <p style="color:#222;">{{ farm.description }}</p>
      <div class="mb-3">
        <div class="progress" style="height: 22px; background:#ffe0b3; border-radius:10px;">
          <div class="progress-bar" role="progressbar" style="width: {{ sponsorship_progress|default:0 }}%; background-color: #d2691e; font-weight:600; font-size:1rem; border-radius:10px; color:#fff;" aria-valuenow="{{ sponsorship_progress|default:0 }}" aria-valuemin="0" aria-valuemax="100">
            {{ sponsorship_progress|default:0 }}%
          </div>
        </div>
      </div>
  {% if farm.sponsorship_is_active %}
  {% else %}
  <div class="alert alert-info mt-2" style="background:#ffe0b3; color:#4b2e1a; border:none; font-weight:600;">Sponsorship for this farm is currently closed.</div>
  {% endif %}
    </div>
    <div class="col-md-5">
  <div class="card shadow border-0 rounded-4" id="sponsor-form" style="background-color: #4b2e1a; color: #fff;">
        <div class="card-body p-4">
          <h2 class="mb-3 text-center" style="font-family: var(--font-heading); color: #ffb366; text-shadow: 1px 1px 2px #2c1810, 0 2px 8px #2c1810;">üå± SPONSOR THIS FARM</h2>
          <p class="lead text-center mb-4" style="color: #fff; text-shadow: 0 1px 4px #2c1810;">Support this farm and empower sustainable coffee communities.</p>
          {% if form_success %}
            <div id="sponsor-success-alert" class="alert alert-success text-center fw-semibold" style="background-color:#d2691e; color:#fff; border:none;">
              Thank you for your sponsorship! We have received your request.
            </div>
            <script>
              setTimeout(function() {
                var alert = document.getElementById('sponsor-success-alert');
                if (alert) { alert.style.display = 'none'; }
              }, 5000);
            </script>
          {% endif %}
          <form method="post" novalidate>
            {% csrf_token %}
            {% if form.errors %}
              <div class="alert alert-danger" id="sponsor-error-alert">
                <strong>There were errors in your submission:</strong>
                <ul class="mb-0">
                {% for field in form %}
                  {% for error in field.errors %}
                    <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                  {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                  <li>{{ error }}</li>
                {% endfor %}
                </ul>
              </div>
              <script>
                setTimeout(function() {
                  var alert = document.getElementById('sponsor-error-alert');
                  if (alert) { alert.style.display = 'none'; }
                }, 5000);
              </script>
            {% endif %}

            <!-- Sponsor Information -->
            <h5 class="mt-3 mb-2" style="color: #ffe0b3; text-shadow: 1px 1px 2px #2c1810, 0 2px 8px #2c1810;">Your Information</h5>
            <div class="mb-3">
              <label for="id_sponsor_name" class="form-label" style="color:#fff; text-shadow: 0 1px 4px #2c1810;">Full Name / Organization Name</label>
              {{ form.sponsor_name }}
              {% for error in form.sponsor_name.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_sponsor_email" class="form-label" style="color:#fff; text-shadow: 0 1px 4px #2c1810;">Email Address</label>
              {{ form.sponsor_email }}
              {% for error in form.sponsor_email.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
            </div>

            <!-- Sponsorship Details -->
            <h5 class="mt-4 mb-2" style="color: #ffe0b3; text-shadow: 1px 1px 2px #2c1810, 0 2px 8px #2c1810;">Sponsorship Details</h5>
            <div class="mb-3">
              <label for="id_amount" class="form-label" style="color:#fff; text-shadow: 0 1px 4px #2c1810;">Sponsorship Amount (Rwf)</label>
              {{ form.amount }}
              {% for error in form.amount.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
            </div>
            <div class="mb-3">
              <label for="id_message" class="form-label" style="color:#fff; text-shadow: 0 1px 4px #2c1810;">Message (optional)</label>
              {{ form.message }}
              {% for error in form.message.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
            </div>
            <button type="submit" class="btn w-100 sponsor-btn-pro" style="background-color: #d2700d; color: #fff; border: none; font-weight: 700; font-size:1.15rem; border-radius:0.75rem; box-shadow: 0 2px 12px rgba(210,112,13,0.18); letter-spacing:0.5px; padding:0.85rem 0; transition: background 0.2s, box-shadow 0.2s;">
              <span style="font-size:1.2em; vertical-align:middle;">ü§ù</span> Sponsor Now
            </button>
</div>
<style>
  .sponsor-btn-pro:hover, .sponsor-btn-pro:focus {
    background-color: #b95e09 !important;
    box-shadow: 0 4px 18px rgba(210,112,13,0.22);
    color: #fff;
    text-decoration: none;
    outline: none;
  }
</style>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
