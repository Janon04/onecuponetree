{% extends 'base.html' %}
{% load i18n static %}

{% block title %}{% trans "Plant a Tree" %}{% endblock %}

{% block content %}
<div class="container py-4" style="background-color: #fff;">
    <div class="row justify-content-center">
        <div class="col-lg-9 col-md-11">
            <div class="card shadow border-0 rounded-4" style="background-color: #4b2e1a; color: #fff; min-height: 720px; min-width: 520px;">
                <div class="card-body p-5" style="min-height: 600px;">
                    <h2 class="mb-2 text-center" style="font-family: var(--font-heading); color: #ffb366; text-shadow: 1px 1px 2px #2c1810; font-size: 1.6rem;">
                        ðŸŒ³ {% trans "Tree Planting Initiative" %}
                    </h2>
                    <p class="text-center mb-3" style="color: #f5f5f5; font-size: 1rem;">
                        {% trans "Join us in making the world greener! Fill out this form to take part in our tree-planting initiative." %}
                    </p>

                    {% if messages %}
                        {% for message in messages %}
                            <div id="plant-success-alert" class="alert alert-success text-center fw-semibold" style="background-color:#d2691e; color:#fff; border:none; font-size:0.95rem;">
                                {{ message }}
                            </div>
                        {% endfor %}
                        <script>
                            setTimeout(function() {
                                var alertElem = document.getElementById('plant-success-alert');
                                if (alertElem) { alertElem.style.display = 'none'; }
                            }, 5000);
                        </script>
                    {% endif %}

                    <form method="post" enctype="multipart/form-data" novalidate>
                        {% csrf_token %}
                        {% if form.errors %}
                            <div class="alert alert-danger" style="font-size:0.95rem;">
                                <strong>{% trans "There were errors in your submission:" %}</strong>
                                <ul class="mb-0">
                                {% for field in form %}
                                    {% for error in field.errors %}
                                        <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                                    {% endfor %}
                                {% endfor %}
                                {% for error in form.non_field_errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                                </ul>
                            </div>
                        {% endif %}

                        <!-- 1. Tree Details -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">1. {% trans "Tree Details" %}</h6>
                        <div class="row g-2">
                            <div class="col-md-6 mb-2">
                                <label for="id_tree_type" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Tree Type" %}</label>
                                <div class="small">{{ form.tree_type }}</div>
                                {% for error in form.tree_type.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-6 mb-2">
                                <label for="id_quantity" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Quantity (Number of Trees)" %}</label>
                                <div class="small">{{ form.quantity }}</div>
                                {% for error in form.quantity.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                        </div>

                        <!-- 2. Location Details -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">2. {% trans "Location Details" %}</h6>
                        <div class="row g-2">
                            <div class="col-md-4 mb-2">
                                <label for="id_country" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Country" %}</label>
                                <div class="small">{{ form.country }}</div>
                                {% for error in form.country.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-4 mb-2">
                                <label for="id_province" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Province" %}</label>
                                <div class="small">{{ form.province }}</div>
                                {% for error in form.province.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-4 mb-2">
                                <label for="id_district" class="form-label mb-1" style="font-size:0.97rem;">{% trans "District" %}</label>
                                <div class="small">{{ form.district }}</div>
                                {% for error in form.district.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-4 mb-2">
                                <label for="id_sector" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Sector" %}</label>
                                <div class="small">{{ form.sector }}</div>
                                {% for error in form.sector.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-4 mb-2">
                                <label for="id_cell" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Cell" %}</label>
                                <div class="small">{{ form.cell }}</div>
                                {% for error in form.cell.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-4 mb-2">
                                <label for="id_village" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Village" %}</label>
                                <div class="small">{{ form.village }}</div>
                                {% for error in form.village.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-6 mb-2">
                                <label for="id_latitude" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Latitude" %}</label>
                                <div class="small">{{ form.latitude }}</div>
                                {% for error in form.latitude.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-6 mb-2">
                                <label for="id_longitude" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Longitude" %}</label>
                                <div class="small">{{ form.longitude }}</div>
                                {% for error in form.longitude.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                        </div>

                        <!-- 3. Planting Date -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">3. {% trans "Planting Date" %}</h6>
                        <div class="mb-2">
                            <label for="id_planting_date" class="form-label mb-1" style="font-size:0.97rem;">{% trans "When will/did you plant the tree(s)?" %}</label>
                            <div class="small">{{ form.planting_date }}</div>
                            {% for error in form.planting_date.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                        </div>


                        <!-- 4. Contribution Type -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">4. {% trans "Contribution Type" %}</h6>
                        <div class="mb-2">
                            <span class="form-label mb-1 d-block" style="font-size:0.97rem;">{{ form.contribution_type.label }}</span>
                            <div class="small">
                                {% for radio in form.contribution_type %}
                                    <div class="form-check mb-1">
                                        {{ radio.tag }}
                                        <label class="form-check-label" style="font-size:0.97rem; margin-left:4px;">{{ radio.choice_label }}</label>
                                    </div>
                                {% endfor %}
                            </div>
                            {% for error in form.contribution_type.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                        </div>

                        <!-- 5. Your Details -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">5. {% trans "Your Details" %}</h6>
                        <div class="row g-2">
                            <div class="col-md-6 mb-2">
                                <label for="id_full_name" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Full Name" %}</label>
                                <div class="small">{{ form.full_name }}</div>
                                {% for error in form.full_name.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                            <div class="col-md-6 mb-2">
                                <label for="id_contact" class="form-label mb-1" style="font-size:0.97rem;">{% trans "Email Address / Phone Number" %}</label>
                                <div class="small">{{ form.contact }}</div>
                                {% for error in form.contact.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                        </div>

                        <!-- 6. Reason for Planting (Optional) -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">6. {% trans "Reason for Planting (Optional)" %}</h6>
                        <div class="mb-2">
                            <label for="id_reason" class="form-label mb-1 d-block" style="font-size:0.97rem;">{{ form.reason.label }}</label>
                            <textarea id="id_reason" name="reason" class="form-control form-control-sm" rows="2" style="font-size:0.97rem;">{{ form.reason.value }}</textarea>
                            {% for error in form.reason.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                        </div>

                        <!-- 7. Upload a Photo (Optional) -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">7. {% trans "Upload a Photo (Optional)" %}</h6>
                        <div class="mb-2">
                            <label for="id_photo" class="form-label mb-1 d-block" style="font-size:0.97rem;">{{ form.photo.label }}</label>
                            <input type="file" name="photo" id="id_photo" class="form-control form-control-sm" style="font-size:0.97rem;" accept="image/*">
                            {% for error in form.photo.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                        </div>

                        <!-- 8. Agreement/Consent -->
                        <h6 class="mt-3 mb-2 text-warning" style="font-size:1.05rem;">8. {% trans "Agreement/Consent" %}</h6>
                        <div class="mb-2">
                            <div class="form-check">
                                {{ form.agreement }}
                                <label class="form-check-label small" for="id_agreement" style="font-size:0.97rem;">
                                    {% trans "I commit to ensuring the planted trees are cared for and maintained." %}
                                </label>
                                {% for error in form.agreement.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                        </div>

                        <div class="d-grid mt-3">
                            <button type="submit" class="btn btn-warning fw-bold" style="color: #2c1810; font-size:1.08rem;">{% trans "Join the Green Movement" %}</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}