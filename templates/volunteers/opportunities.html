{% extends "base.html" %}
{% load i18n %}
{% block title %}{% trans "Volunteer Opportunities" %}{% endblock %}
{% block content %}
<div class="container py-5">
    <h1 class="section-title">{% trans "Volunteer Opportunities" %}</h1>
    {% if opportunities %}
        <div class="blog-list-vertical">
            {% for opportunity in opportunities %}
            <div class="card mb-4 border-0 shadow-lg rounded-4 blog-card-pro d-flex flex-row align-items-stretch" style="background-color: #fff7ef; color: #4b2e1a; transition: box-shadow 0.3s; min-height:220px;">
                {% if opportunity.image or opportunity.video %}
                <div class="blog-media-zoom-wrapper d-flex align-items-center justify-content-center" style="width: 240px; max-width: 40vw; background: #e6d3c2; border-top-left-radius:1.2rem; border-bottom-left-radius:1.2rem; overflow:hidden;">
                    {% if opportunity.video %}
                        <video class="blog-media-zoom" style="width:100%;height:180px;object-fit:cover;cursor:pointer;" controls poster="{% if opportunity.image %}{{ opportunity.image.url }}{% endif %}">
                            <source src="{{ opportunity.video.url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    {% elif opportunity.image %}
                        <img src="{{ opportunity.image.url }}" class="blog-media-zoom" style="width:100%;height:180px;object-fit:cover;cursor:pointer;" alt="Volunteer Opportunity Image" loading="lazy" onclick="showMediaModal('{{ opportunity.image.url }}', 'image')">
                    {% endif %}
                </div>
                {% endif %}
                <div class="card-body d-flex flex-column p-4 justify-content-between" style="flex:1 1 0;">
                    <div>
                        <h5 class="card-title mb-1" style="color:#d2700d; font-weight:700; font-size:1.15rem; letter-spacing:0.5px;">{{ opportunity.title }}</h5>
                        <p class="card-text small mb-2" style="color:#4b2e1a; opacity:0.7; font-weight:500;">
                            <i class="fa fa-calendar-alt me-1"></i> {{ opportunity.start_date }} - {{ opportunity.end_date }}
                            {% if opportunity.location %} &nbsp; <i class="fa fa-map-marker-alt me-1"></i> {{ opportunity.location }}{% endif %}
                        </p>
                        <p class="card-text" style="min-height:3.2em;color:#000;opacity:1;">{{ opportunity.description|safe }}</p>
                    </div>
                    <a href="{% url 'volunteers:opportunity_detail' opportunity.pk %}" class="btn mt-3 align-self-end" style="background-color: #d2700d; color: #fff; border: none; font-weight: 700; font-size:1.05rem; box-shadow: 0 2px 12px rgba(210,112,13,0.10); border-radius:0.6rem; letter-spacing:0.5px; min-width:140px;">{% trans "View Details" %}</a>
                </div>
            </div>
            {% endfor %}
        </div>
        <!-- Modal for image zoom -->
        <div class="modal fade" id="mediaModal" tabindex="-1" aria-labelledby="mediaModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="background:rgba(0,0,0,0.85);border:none;box-shadow:0 8px 32px rgba(34,22,10,0.25);">
              <div class="modal-body text-center p-0">
                <img id="modalImage" src="" alt="Media" style="max-width:100%;max-height:70vh;display:none;" />
                <video id="modalVideo" controls style="max-width:100%;max-height:70vh;display:none;"></video>
              </div>
              <div class="modal-footer justify-content-center border-0" style="background:none;">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
        <script>
        function showMediaModal(url, type) {
            var img = document.getElementById('modalImage');
            var vid = document.getElementById('modalVideo');
            if(type === 'image') {
                img.src = url;
                img.style.display = 'block';
                vid.style.display = 'none';
            } else if(type === 'video') {
                vid.src = url;
                vid.style.display = 'block';
                img.style.display = 'none';
            }
            var modal = new bootstrap.Modal(document.getElementById('mediaModal'));
            modal.show();
        }
        </script>
<style>
    .blog-list-vertical .blog-card-pro {
        flex-direction: row;
        min-height: 220px;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 32px rgba(34,22,10,0.13), 0 2px 12px rgba(210,112,13,0.13);
        transition: box-shadow 0.3s, transform 0.3s;
    }
    .blog-list-vertical .blog-card-pro:hover {
        box-shadow: 0 12px 36px rgba(34,22,10,0.18), 0 4px 16px rgba(210,112,13,0.16);
        transform: translateY(-2px) scale(1.01);
    }
    .blog-list-vertical .blog-media-zoom-wrapper:hover .blog-media-zoom {
        transform: scale(1.07);
        z-index: 2;
        box-shadow: 0 8px 24px rgba(0,0,0,0.13);
        filter: brightness(1.06) contrast(1.06);
    }
    .blog-list-vertical .blog-media-zoom {
        transition: transform 0.5s cubic-bezier(.4,2,.6,1), filter 0.5s;
        cursor: zoom-in;
    }
    .blog-list-vertical .blog-media-overlay {
        border-top-left-radius:1.2rem; border-bottom-left-radius:1.2rem;
    }
    @media (max-width: 991px) {
        .blog-list-vertical .blog-card-pro { border-radius: 0.8rem !important; flex-direction: column; }
        .blog-list-vertical .blog-media-overlay { border-top-left-radius:0.8rem; border-top-right-radius:0.8rem; border-bottom-left-radius:0.8rem; }
        .blog-list-vertical .blog-media-zoom-wrapper { width: 100% !important; max-width: 100vw !important; border-bottom-left-radius:0.8rem; border-top-right-radius:0.8rem; }
        .blog-list-vertical .blog-media-zoom { height: 220px !important; }
    }
    @media (max-width: 767px) {
        .blog-list-vertical .blog-card-pro { border-radius: 0.5rem !important; flex-direction: column; }
        .blog-list-vertical .blog-media-overlay { border-top-left-radius:0.5rem; border-top-right-radius:0.5rem; border-bottom-left-radius:0.5rem; }
        .blog-list-vertical .blog-media-zoom-wrapper { width: 100% !important; max-width: 100vw !important; border-bottom-left-radius:0.5rem; border-top-right-radius:0.5rem; }
        .blog-list-vertical .blog-media-zoom { height: 180px !important; }
    }
</style>
    {% else %}
    <div class="alert alert-info">{% trans "No volunteer opportunities available at the moment." %}</div>
    {% endif %}
</div>
{% endblock %}
